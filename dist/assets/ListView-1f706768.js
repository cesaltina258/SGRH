import{d as R,l as r,c as O,J as G,B as L,b,e as F,w as a,x as t,O as M,aD as A,C as K,y as te,a1 as ae,h as D,D as J,G as U,i as u,Q as k,I as h,f as B,a3 as le,ab as se,Z as ie,aI as q,K as de,L as ce,af as me,m as ve,M as N,aF as ye,N as fe,g as z,R as ge,H as pe,F as Q,E as he,S as _e,V as Ce,W as Ve}from"./index-1db35709.js";import{_ as be}from"./TableAction.vue_vue_type_script_setup_true_lang-6eb16471.js";import{D as $e}from"./DataTableServer-f256364c.js";const xe=[{title:"currencies",disabled:!1},{title:"view-list-currency",disabled:!0}],Y=[{title:"name",key:"name",sortable:!0},{title:"symbol",key:"symbol",sortable:!0},{title:"action",sortable:!1}],we={class:"font-weight-bold text-caption mb-1"},Se=u("i",{class:"ph-asterisk ph-xs text-danger"},null,-1),Ie={key:0,class:"text-red text-extra-small pt-1"},Pe={class:"font-weight-bold text-caption mb-1"},De=u("i",{class:"ph-asterisk ph-xs text-danger"},null,-1),Ee={key:0,class:"text-red text-extra-small pt-1"},Ue=u("i",{class:"ph-x me-1"},null,-1),ke=R({__name:"CreateUpdateCurrencyModal",props:{modelValue:{type:Boolean,default:!1},data:{type:Object,required:!0},error:{type:String,default:""}},emits:["update:modelValue","onSubmit"],setup(y,{emit:f}){const g=r(!1),v=f,x=y,$=O(()=>x.data.id==="-1"),d=r(x.data),_=O(()=>x.error),m=O({get(){return x.modelValue},set(s){v("update:modelValue",s)}}),C=r(d.value.id||""),c=r(d.value.name||""),i=r(d.value.symbol||""),l=r({name:"",symbol:""}),{t:E}=G(),I=()=>{let s=!0;return Object.keys(l.value).forEach(V=>{l.value[V]=""}),c.value||(l.value.name=E("t-please-enter-name-currency"),s=!1),i.value?i.value.length<2||i.value.length>10?(l.value.symbol=E("t-symbol-must-be-between-2-and-10-chars"),s=!1):l.value.symbol="":(l.value.symbol=E("t-please-enter-symbol"),s=!1),s},w=()=>{if(!I())return;g.value=!0;const s={...!$.value&&{id:C.value},name:c.value,symbol:i.value};v("onSubmit",s,{onSuccess:()=>{m.value=!1},onFinally:()=>{g.value=!1}})};return(s,V)=>{const T=L("TextField"),H=L("Card");return b(),F(se,{modelValue:m.value,"onUpdate:modelValue":V[4]||(V[4]=P=>m.value=P),width:"500",scrollable:""},{default:a(()=>[t(H,{title:$.value?s.$t("t-add-currency"):s.$t("t-edit-currency"),"title-class":"py-0",style:{overflow:"hidden"}},{"title-action":a(()=>[t(M,{icon:"ph-x",variant:"plain",onClick:V[0]||(V[0]=P=>m.value=!1)})]),default:a(()=>[t(A),t(K,{class:"overflow-y-auto",style:te({"max-height":$.value?"70vh":"45vh"})},{default:a(()=>[_.value?(b(),F(ae,{key:0,text:_.value,type:"error",class:"mb-4",variant:"tonal",color:"danger",density:"compact"},null,8,["text"])):D("",!0),t(J,null,{default:a(()=>[t(U,{cols:"12",lg:"6"},{default:a(()=>[u("div",we,[k(h(s.$t("t-name"))+" ",1),Se]),t(T,{modelValue:c.value,"onUpdate:modelValue":V[1]||(V[1]=P=>c.value=P),placeholder:s.$t("t-enter-name"),"error-messages":l.value.name?[l.value.name]:[],"hide-details":""},null,8,["modelValue","placeholder","error-messages"]),l.value.name?(b(),B("div",Ie,h(l.value.name),1)):D("",!0)]),_:1}),t(U,{cols:"12",lg:"6"},{default:a(()=>[u("div",Pe,[k(h(s.$t("t-symbol"))+" ",1),De]),t(T,{modelValue:i.value,"onUpdate:modelValue":V[2]||(V[2]=P=>i.value=P),placeholder:s.$t("t-enter-symbol"),"error-messages":l.value.symbol?[l.value.symbol]:[],"hide-details":""},null,8,["modelValue","placeholder","error-messages"]),l.value.symbol?(b(),B("div",Ee,h(l.value.symbol),1)):D("",!0)]),_:1})]),_:1})]),_:1},8,["style"]),t(A),t(le,{class:"d-flex justify-end"},{default:a(()=>[u("div",null,[t(M,{color:"danger",class:"me-1",onClick:V[3]||(V[3]=P=>m.value=!1)},{default:a(()=>[Ue,k(" "+h(s.$t("t-close")),1)]),_:1}),t(M,{color:"primary",variant:"elevated",onClick:w,loading:g.value,disabled:g.value},{default:a(()=>[k(h(g.value?s.$t("t-saving"):s.$t("t-save")),1)]),_:1},8,["loading","disabled"])])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}});const Oe={class:"font-weight-bold text-caption mb-1"},Be=u("i",{class:"ph-asterisk ph-xs text-danger"},null,-1),Te={key:0,class:"text-red text-extra-small pt-1"},Fe={class:"font-weight-bold text-caption mb-1"},Me=u("i",{class:"ph-asterisk ph-xs text-danger"},null,-1),je={key:0,class:"text-red text-extra-small pt-1"},ze=u("i",{class:"ph-x me-1"},null,-1),Le=R({__name:"ViewCurrencyModal",props:{modelValue:{type:Boolean,default:!1},data:{type:Object,required:!0},error:{type:String,default:""}},emits:["update:modelValue","onSubmit"],setup(y,{emit:f}){r(!1);const g=f,v=y,x=O(()=>v.data.id==="-1"),$=r(v.data),d=O(()=>v.error),_=O({get(){return v.modelValue},set(i){g("update:modelValue",i)}});r($.value.id||"");const m=r($.value.name||""),C=r($.value.symbol||""),c=r({name:"",symbol:""});return G(),(i,l)=>{const E=L("TextField"),I=L("Card");return b(),F(se,{modelValue:_.value,"onUpdate:modelValue":l[4]||(l[4]=w=>_.value=w),width:"500",scrollable:""},{default:a(()=>[t(I,{title:i.$t("t-view-currency"),"title-class":"py-0",style:{overflow:"hidden"}},{"title-action":a(()=>[t(M,{icon:"ph-x",variant:"plain",onClick:l[0]||(l[0]=w=>_.value=!1)})]),default:a(()=>[t(A),t(K,{class:"overflow-y-auto",style:te({"max-height":x.value?"70vh":"45vh"})},{default:a(()=>[d.value?(b(),F(ae,{key:0,text:d.value,type:"error",class:"mb-4",variant:"tonal",color:"danger",density:"compact"},null,8,["text"])):D("",!0),t(J,null,{default:a(()=>[t(U,{cols:"12",lg:"6"},{default:a(()=>[u("div",Oe,[k(h(i.$t("t-name"))+" ",1),Be]),t(E,{modelValue:m.value,"onUpdate:modelValue":l[1]||(l[1]=w=>m.value=w),placeholder:i.$t("t-enter-name"),"error-messages":c.value.name?[c.value.name]:[],"hide-details":"",disabled:""},null,8,["modelValue","placeholder","error-messages"]),c.value.name?(b(),B("div",Te,h(c.value.name),1)):D("",!0)]),_:1}),t(U,{cols:"12",lg:"6"},{default:a(()=>[u("div",Fe,[k(h(i.$t("t-symbol"))+" ",1),Me]),t(E,{modelValue:C.value,"onUpdate:modelValue":l[2]||(l[2]=w=>C.value=w),placeholder:i.$t("t-enter-symbol"),"error-messages":c.value.symbol?[c.value.symbol]:[],"hide-details":"",disabled:""},null,8,["modelValue","placeholder","error-messages"]),c.value.symbol?(b(),B("div",je,h(c.value.symbol),1)):D("",!0)]),_:1})]),_:1})]),_:1},8,["style"]),t(A),t(le,{class:"d-flex justify-end"},{default:a(()=>[u("div",null,[t(M,{color:"danger",class:"me-1",onClick:l[3]||(l[3]=w=>_.value=!1)},{default:a(()=>[ze,k(" "+h(i.$t("t-close")),1)]),_:1})])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}});const Ne=ie("currencies",{state:()=>({currencies:[],pagination:{totalElements:0,currentPage:0,itemsPerPage:10,totalPages:0},loading:!1,error:null,draftCurrency:null,currentCurrencyId:null}),actions:{async fetchCurrencies(y,f,g="name",v="asc",x,$){this.loading=!0,this.error=null;const d=y??this.pagination.currentPage,_=f??this.pagination.itemsPerPage;try{const{content:m,meta:C}=await q.getCurrencies(d,_,g,v,x,$);this.currencies=m,this.pagination={totalElements:C.totalElements,currentPage:C.page,itemsPerPage:C.size,totalPages:C.totalPages||Math.ceil(C.totalElements/C.size)},console.log("🌍 Países:",this.currencies),console.log("📄 Meta:",this.pagination)}catch(m){this.error=m.message||"Erro ao buscar currencies",this.currencies=[],this.pagination.totalElements=0,console.error("❌ Erro ao buscar currencies:",m)}finally{this.loading=!1}},setDraftCurrency(y){this.draftCurrency=y,localStorage.setItem("countryDraft",JSON.stringify(y)),console.log("🌍 Draft de país salvo:",this.draftCurrency)},setCurrentCountryId(y){this.currentCurrencyId=y,localStorage.setItem("currentCurrencyId",y),console.log("🌍 ID do Currency atual salvo:",this.currentCurrencyId)},clearDraft(){this.draftCurrency=null,this.currentCurrencyId=null,localStorage.removeItem("draftCurrency"),localStorage.removeItem("currentCurrencyId"),console.log("🌍 Draft de Currency e ID atual limpos")},loadFromStorage(){const y=localStorage.getItem("draftCurrency"),f=localStorage.getItem("currentCurrencyId");y&&(this.draftCurrency=JSON.parse(y)),f&&(this.currentCurrencyId=f),console.log("🌍 Carregando draft de Currency e ID atual do armazenamento:",this.draftCurrency,this.currentCurrencyId)}}}),qe={class:"text-body-1 font-weight-bold"},Ae=u("i",{class:"ph-plus-circle me-1"},null,-1),Je={style:{"padding-right":"200px"}},Re={style:{"padding-right":"200px"}},He=["colspan"],Qe=u("i",{class:"ph-magnifying-glass",style:{"font-size":"30px"}},null,-1),Ge={class:"text-subtitle-1 font-weight-bold mt-3"},ee="name,symbol",Ke=R({__name:"index",setup(y){const{t:f}=G(),g=de(),v=Ne();ce();const x=r(!1),$=r(!1),d=r(null),_=r(!1),m=r(null),C=r(!1);r(!1);const c=r(""),i=r(10),l=O(()=>v.loading),E=O(()=>v.pagination.totalElements),I=r([]),w=r("");let s=null;const V=e=>{var n,p,S,j,W,Z,X;s&&(clearTimeout(s),s=null);const o=((W=(j=(S=(p=(n=e==null?void 0:e.response)==null?void 0:n.data)==null?void 0:p.error)==null?void 0:S.errors)==null?void 0:j.name)==null?void 0:W[0])||((X=(Z=e==null?void 0:e.response)==null?void 0:Z.data)==null?void 0:X.message)||(e==null?void 0:e.message)||f("t-message-save-error");console.log("message ==",o),w.value=o,s=setTimeout(()=>{w.value="",s=null},5e3)};me(()=>{s&&(clearTimeout(s),s=null)}),ve(()=>{T({page:1,itemsPerPage:i.value,sortBy:[],search:""})}),N(I,e=>{console.log("Funcionários selecionados:",e)},{deep:!0});const T=async({page:e,itemsPerPage:o,sortBy:n,search:p})=>{var S,j;await v.fetchCurrencies(e-1,o,((S=n[0])==null?void 0:S.key)||"name",((j=n[0])==null?void 0:j.order)||"asc",p,ee)},H=e=>{I.value.findIndex(n=>n.id===e.id)===-1?I.value=[...I.value,e]:I.value=I.value.filter(n=>n.id!==e.id)};N(x,e=>{e||(d.value=null)});const P=e=>{e?d.value=e:d.value={id:"-1",name:"",symbol:""},x.value=!0},oe=async(e,o)=>{var n,p;try{e.id?(await q.updateCurrency(e.id,e),g.success(f("t-toast-message-update"))):(await q.createCurrency(e),g.success(f("t-toast-message-created"))),await T({page:1,itemsPerPage:i.value,sortBy:[],search:c.value}),(n=o==null?void 0:o.onSuccess)==null||n.call(o)}catch(S){g.error(f("t-message-save-error")),V(S)}finally{(p=o==null?void 0:o.onFinally)==null||p.call(o)}};N($,e=>{e||(d.value=null)});const ne=e=>{e?d.value=e:d.value={id:"-1",name:"",symbol:""},$.value=!0};N(_,e=>{e||(m.value=null)});const re=e=>{m.value=e,_.value=!0},ue=async()=>{C.value=!0;try{await q.deleteCurrency(m.value),await T({page:1,itemsPerPage:i.value,sortBy:[],search:c.value}),g.success(f("t-toast-message-deleted"))}catch(e){g.error(f("t-toast-message-deleted-erros")),V(e)}finally{C.value=!1,_.value=!1}};return(e,o)=>(b(),B(Q,null,[t(Ce,null,{default:a(()=>[t(ye,{class:"mt-2"},{default:a(()=>[t(J,{justify:"space-between",align:"center","no-gutters":""},{default:a(()=>[t(U,{lg:"auto",class:"d-flex align-center"},{default:a(()=>[u("span",qe,h(e.$t("t-currency-list")),1)]),_:1}),t(U,{lg:"8",class:"d-flex justify-end"},{default:a(()=>[t(J,{justify:"end",align:"center","no-gutters":""},{default:a(()=>[t(U,{lg:"4",class:"me-3"},{default:a(()=>[t(fe,{modelValue:c.value,"onUpdate:modelValue":o[0]||(o[0]=n=>c.value=n),placeholder:e.$t("t-search-for-currency")},null,8,["modelValue","placeholder"])]),_:1}),t(U,{lg:"auto"},{default:a(()=>[t(M,{color:"secondary",onClick:o[1]||(o[1]=n=>P(null))},{default:a(()=>[Ae,k(" "+h(e.$t("t-add-currency")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(K,{class:"mt-2"},{default:a(()=>[t($e,{headers:z(Y).map(n=>({...n,title:e.$t(`t-${n.title}`)})),items:z(v).currencies,"items-per-page":i.value,"total-items":E.value,loading:l.value,"search-query":c.value,"search-props":ee,"item-value":"id",onLoadItems:T},ge({body:a(({items:n})=>[(b(!0),B(Q,null,he(n,p=>(b(),B("tr",{key:p.id,height:"50"},[u("td",null,[t(_e,{"model-value":I.value.some(S=>S.id===p.id),"onUpdate:modelValue":S=>H(p),"hide-details":"",density:"compact"},null,8,["model-value","onUpdate:modelValue"])]),u("td",Je,h(p.name),1),u("td",Re,h(p.symbol),1),u("td",null,[t(be,{onOnEdit:S=>P(p),onOnView:S=>ne(p),onOnDelete:S=>re(p.id)},null,8,["onOnEdit","onOnView","onOnDelete"])])]))),128))]),_:2},[z(v).currencies.length?void 0:{name:"body",fn:a(()=>[u("tr",null,[u("td",{colspan:z(Y).length+2,class:"text-center py-10"},[t(pe,{size:"80",color:"primary",variant:"tonal"},{default:a(()=>[Qe]),_:1}),u("div",Ge,h(e.$t("t-search-not-found-message")),1)],8,He)])]),key:"0"}]),1032,["headers","items","items-per-page","total-items","loading","search-query"])]),_:1})]),_:1}),d.value?(b(),F(ke,{key:0,modelValue:x.value,"onUpdate:modelValue":o[2]||(o[2]=n=>x.value=n),data:d.value,error:w.value,onOnSubmit:oe},null,8,["modelValue","data","error"])):D("",!0),d.value?(b(),F(Le,{key:1,modelValue:$.value,"onUpdate:modelValue":o[3]||(o[3]=n=>$.value=n),data:d.value},null,8,["modelValue","data"])):D("",!0),m.value?(b(),F(Ve,{key:2,modelValue:_.value,"onUpdate:modelValue":o[4]||(o[4]=n=>_.value=n),onOnConfirm:ue,loading:C.value},null,8,["modelValue","loading"])):D("",!0)],64))}}),Ye=R({__name:"ListView",setup(y){return(f,g)=>{const v=L("Breadcrumb");return b(),B(Q,null,[t(v,{title:"currency-list",items:z(xe)},null,8,["items"]),t(Ke)],64)}}});export{Ye as default};
