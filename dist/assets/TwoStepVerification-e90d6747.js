import{d as N,J as G,Y as J,L as Y,e3 as z,l as f,c as H,B as O,b as d,f as $,i as u,x as s,w as l,bh as Q,g as B,I as c,T as g,a0 as E,e as h,a1 as D,h as S,aF as W,V as k,G as w,a4 as X,F as Z,E as ee,e4 as te,S as F,D as ae,aK as se,a7 as le}from"./index-96068b83.js";const oe="/assets/permission-225dcaf4.png",ne={class:"h-100 d-flex align-center justify-center"},re={class:"w-100"},ie={class:"text-h6 font-weight-bold mt-4"},ue={class:"text-muted mt-1 font-weight-regular"},ce={class:"mb-3"},de={class:"text-center mt-5 d-flex align-center justify-center"},me=N({__name:"Form",setup(j){const{t:y}=G(),T=J(),K=Y(),x=T.query.email,M=z(),p=f([{value:"",isValid:!0},{value:"",isValid:!0},{value:"",isValid:!0},{value:"",isValid:!0},{value:"",isValid:!0},{value:"",isValid:!0}]),b=f(!1),v=f(!1),o=f(""),_=f("");let V=null;const C=H(()=>p.value.map(e=>e.value).join("")),P=e=>{var i,r;const n=(((i=e.clipboardData)==null?void 0:i.getData("text/plain").trim())||"").replace(/\D/g,"").split("").slice(0,6);n.forEach((I,U)=>{p.value[U].value=I});const a=Math.min(n.length,5)+1;(r=m(a))==null||r.focus(),e.preventDefault()},m=e=>document.getElementById(`digit-${e}`),R=(e,t)=>{var n,a;e.key!=="Backspace"&&/^\d$/.test(e.key)&&(t<7?(n=m(t))==null||n.focus():(a=m(t))==null||a.blur())},q=(e,t)=>{var n,a;e.key==="Backspace"&&(t>0?(n=m(t))==null||n.focus():(a=m(t))==null||a.blur())},A=async()=>{try{if(v.value=!0,o.value="",b.value=!0,p.value.some(t=>!t.value)){o.value=y("t-please-enter-complete-code"),setTimeout(()=>{o.value=""},3e3);return}const e=await se.verifyEmail(x,C.value);console.log("Verification response:",e),M.setToken(e.data.token),_.value=y("t-validanting-code"),setTimeout(()=>{K.push("/auth/pass-change")},2e3)}catch(e){console.error("Verification error:",e),L(e)}finally{v.value=!1}},L=e=>{e.response?o.value=e.response.data.message:e.request?o.value="No response from server.":o.value=e.message,V&&clearTimeout(V),V=setTimeout(()=>{o.value=""},3e3)};return(e,t)=>{const n=O("TextField");return d(),$("div",ne,[u("div",re,[s(W,{class:"text-center mt-10"},{default:l(()=>[s(Q,{src:B(oe),height:"60"},null,8,["src"]),u("h5",ie,c(e.$t("t-verify-your-email")),1),u("div",ue,[g(c(e.$t("t-enter-the-6-digit-code"))+" ",1),u("b",null,c(B(x)),1)]),s(E,{name:"fade"},{default:l(()=>[_.value?(d(),h(D,{key:0,text:_.value,type:"warning",class:"mb-4 mx-16 mt-3",variant:"tonal",color:"warning",density:"compact",onClick:t[0]||(t[0]=a=>_.value=""),style:{cursor:"pointer"}},null,8,["text"])):S("",!0)]),_:1}),s(E,{name:"fade"},{default:l(()=>[o.value?(d(),h(D,{key:0,text:o.value,type:"error",class:"mb-4 mx-16 mt-3",variant:"tonal",color:"danger",density:"compact",onClick:t[1]||(t[1]=a=>o.value=""),style:{cursor:"pointer"}},null,8,["text"])):S("",!0)]),_:1})]),_:1}),s(ae,null,{default:l(()=>[s(k,{justify:"center",class:"align-center"},{default:l(()=>[s(w,{cols:"12",lg:"8"},{default:l(()=>[s(k,{class:"mt-4",onPaste:X(P,["prevent"])},{default:l(()=>[(d(!0),$(Z,null,ee(p.value,(a,i)=>(d(),h(w,{cols:"2",key:i},{default:l(()=>[u("div",ce,[s(n,{class:"two-step-verification-field",modelValue:a.value,"onUpdate:modelValue":r=>a.value=r,id:`digit-${i+1}`,placeholder:"0",maxLength:"1",isRequired:"",showError:b.value&&!a.value,"hide-details":"",onKeyup:[r=>R(r,i+2),te(r=>q(r,i),["delete"])],inputmode:"numeric",pattern:"[0-9]*"},null,8,["modelValue","onUpdate:modelValue","id","showError","onKeyup"])])]),_:2},1024))),128))]),_:1},8,["onPaste"])]),_:1})]),_:1}),s(k,{justify:"center",class:"align-center mt-4"},{default:l(()=>[s(w,{cols:"12",lg:"8"},{default:l(()=>[s(F,{color:"primary",block:"",height:"40",onClick:A,loading:v.value,disabled:v.value||C.value.length<6},{default:l(()=>[g(c(e.$t("t-confirm")),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1}),u("div",de,[g(c(e.$t("t-didnt-receive-a-code"))+" ",1),s(F,{to:"/auth/pass-reset",variant:"text",color:"primary",class:"font-weight-bold text-decoration-underline pa-0"},{default:l(()=>[g(c(e.$t("t-resent")),1)]),_:1})])]),_:1})])])}}});const fe=le(me,[["__scopeId","data-v-651d1cdd"]]),ve=N({__name:"TwoStepVerification",setup(j){return(y,T)=>(d(),h(fe))}});export{ve as default};
