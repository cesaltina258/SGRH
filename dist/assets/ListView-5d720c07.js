import{d as Q,c as O,b as y,e as Y,w as o,x as t,V as L,G as x,R as Ce,a2 as Ve,g as Z,D as M,C as se,l as i,J as de,B as j,ab as be,S as R,aD as ue,y as $e,i as n,T as C,I as u,f as _,h as $,a3 as ie,Z as ce,aH as ve,aI as K,Y as xe,K as Se,L as we,M as E,m as De,O as Ie,F as re,a4 as ke,aG as Be,E as Ue,H as Pe}from"./index-96068b83.js";import{s as Oe,f as Fe}from"./utils-8990985e.js";import{u as Te}from"./countryStore-b6395f06.js";import{u as Ee}from"./provinceStore-27778dcc.js";const Le=[{title:"countries",disabled:!1},{title:"view-list-country",disabled:!0},{title:"edit-country",disabled:!0}],qe=[{title:"",isCheck:!0},{title:"province-name"},{title:"province-code"},{title:"action"}],Me=[{title:"view",icon:"ph-eye",value:"view"},{title:"edit",icon:"ph-pencil",value:"edit"},{title:"delete",icon:"ph-trash",value:"delete"}],je=Q({__name:"HistoryFilters",props:{modelValue:{type:Object,default:()=>{}}},emits:["update:modelValue"],setup(B,{emit:p}){const V=p,b=B,I=O({get(){return b.modelValue.query||""},set(f){V("update:modelValue",{...b.modelValue,query:f})}}),F=O({get(){return b.modelValue.status||""},set(f){V("update:modelValue",{...b.modelValue,status:f})}});return O({get(){return b.modelValue.date||""},set(f){V("update:modelValue",{...b.modelValue,date:f})}}),(f,S)=>(y(),Y(se,null,{default:o(()=>[t(M,null,{default:o(()=>[t(L,null,{default:o(()=>[t(x,{cols:"12",sm:"4",lg:"lg"},{default:o(()=>[t(Ce,{modelValue:I.value,"onUpdate:modelValue":S[0]||(S[0]=w=>I.value=w),placeholder:f.$t("t-search-for-province")},null,8,["modelValue","placeholder"])]),_:1}),t(x,{cols:"12",lg:"2"},{default:o(()=>[t(Ve,{modelValue:F.value,"onUpdate:modelValue":S[1]||(S[1]=w=>F.value=w),items:Z(Oe),placeholder:f.$t("t-select-status")},null,8,["modelValue","items","placeholder"])]),_:1})]),_:1})]),_:1})]),_:1}))}}),Re={class:"font-weight-bold text-caption mb-1"},Ae=n("i",{class:"ph-asterisk ph-xs text-danger"},null,-1),He={key:0,class:"text-red text-extra-small pt-1"},Ne={class:"font-weight-bold text-caption mb-1"},ze=n("i",{class:"ph-asterisk ph-xs text-danger"},null,-1),Ge={key:0,class:"text-red text-extra-small pt-1"},We=n("i",{class:"ph-x me-1"},null,-1),Je=Q({__name:"CreateUpdateProvinceModal",props:{modelValue:{type:Boolean,default:!1},data:{type:Object,required:!0},country:{type:String,required:!0}},emits:["update:modelValue","onSubmit"],setup(B,{emit:p}){const V=i(!1),b=p,I=B,F=O(()=>I.data.id==="-1"),f=i({...I.data,country:I.country}),S=O({get(){return I.modelValue},set(v){b("update:modelValue",v)}}),w=i(f.value.id||""),q=i(f.value.name||""),l=i(f.value.code||""),{t:d}=de(),c=i({name:"",code:""}),X=()=>{let v=!0;return Object.keys(c.value).forEach(h=>{c.value[h]=""}),q.value||(c.value.name=d("t-please-enter-province-name"),v=!1),l.value?l.value.length<2||l.value.length>10?(c.value.code=d("t-province-code-must-be-between-2-and-10-chars"),v=!1):c.value.code="":(c.value.code=d("t-please-enter-province-code"),v=!1),v},ee=()=>{if(!X())return;V.value=!0;const v={...!F.value&&{id:w.value},name:q.value,code:l.value,country:I.country};b("onSubmit",v,{onSuccess:()=>{S.value=!1},onFinally:()=>{V.value=!1}})};return(v,h)=>{const D=j("TextField"),s=j("Card");return y(),Y(be,{modelValue:S.value,"onUpdate:modelValue":h[4]||(h[4]=U=>S.value=U),width:"500",scrollable:""},{default:o(()=>[t(s,{title:F.value?v.$t("t-add-province"):v.$t("t-edit-province"),"title-class":"py-0",style:{overflow:"hidden"}},{"title-action":o(()=>[t(R,{icon:"ph-x",variant:"plain",onClick:h[0]||(h[0]=U=>S.value=!1)})]),default:o(()=>[t(ue),t(M,{class:"overflow-y-auto",style:$e({"max-height":F.value?"70vh":"45vh"})},{default:o(()=>[t(L,null,{default:o(()=>[t(x,{cols:"12",lg:"6"},{default:o(()=>[n("div",Re,[C(u(v.$t("t-name"))+" ",1),Ae]),t(D,{modelValue:q.value,"onUpdate:modelValue":h[1]||(h[1]=U=>q.value=U),placeholder:v.$t("t-enter-name"),"error-messages":c.value.name?[c.value.name]:[],"hide-details":""},null,8,["modelValue","placeholder","error-messages"]),c.value.name?(y(),_("div",He,u(c.value.name),1)):$("",!0)]),_:1}),t(x,{cols:"12",lg:"6"},{default:o(()=>[n("div",Ne,[C(u(v.$t("t-province-code"))+" ",1),ze]),t(D,{modelValue:l.value,"onUpdate:modelValue":h[2]||(h[2]=U=>l.value=U),placeholder:v.$t("t-enter-code"),"error-messages":c.value.code?[c.value.code]:[],"hide-details":""},null,8,["modelValue","placeholder","error-messages"]),c.value.code?(y(),_("div",Ge,u(c.value.code),1)):$("",!0)]),_:1})]),_:1})]),_:1},8,["style"]),t(ue),t(ie,{class:"d-flex justify-end"},{default:o(()=>[n("div",null,[t(R,{color:"danger",class:"me-1",onClick:h[3]||(h[3]=U=>S.value=!1)},{default:o(()=>[We,C(" "+u(v.$t("t-close")),1)]),_:1}),t(R,{color:"primary",variant:"elevated",onClick:ee,loading:V.value,disabled:V.value},{default:o(()=>[C(u(V.value?v.$t("t-saving"):v.$t("t-save")),1)]),_:1},8,["loading","disabled"])])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}});const Ke=ce("country_id",{state:()=>({country_id:null,error:null}),actions:{async fetchCountryByID(B){this.error=null;try{const p=await ve.getCountryByID(B);return this.country_id=p.data,p.data}catch(p){return this.error=p.message||"Erro ao buscar país por ID",console.error("❌ Erro ao buscar país por ID:",p),null}}}}),Ye=ce("country_by_province",{state:()=>({country_by_province:null,error:null}),actions:{async fetchProvinceByCountryID(B){this.error=null;try{const p=await K.getProvinceByCountryID(B);return this.country_by_province=p.data,p.data}catch(p){return this.error=p.message||"Erro ao buscar país por ID",console.error("❌ Erro ao buscar país por ID:",p),null}}}}),Ze={class:"font-weight-bold mb-2"},Qe=n("i",{class:"ph-asterisk ph-xs text-danger"},null,-1),Xe={key:0,class:"text-red text-extra-small pt-1"},et={class:"font-weight-bold mb-2"},tt=n("i",{class:"ph-asterisk ph-xs text-danger"},null,-1),lt={key:0,class:"text-red text-extra-small pt-1"},at={class:"font-weight-bold mb-2"},ot=n("i",{class:"ph-asterisk ph-xs text-danger"},null,-1),st={key:0,class:"text-red text-extra-small pt-1"},rt={class:"font-weight-bold mb-2"},nt=n("i",{class:"ph-asterisk ph-xs text-danger"},null,-1),ut={key:0,class:"text-red text-extra-small pt-1"},dt={class:"font-weight-bold mb-2"},it=n("i",{class:"ph-asterisk ph-xs text-danger"},null,-1),ct={key:0,class:"text-red text-extra-small pt-1"},vt={class:"font-weight-bold mb-2"},mt=n("i",{class:"ph-asterisk ph-xs text-danger"},null,-1),pt={key:0,class:"text-red text-extra-small pt-1"},yt={class:"font-weight-bold mb-2"},ft=n("i",{class:"ph-asterisk ph-xs text-danger"},null,-1),ht={key:0,class:"text-red text-extra-small pt-1"},gt={class:"font-weight-bold mb-2"},_t=n("i",{class:"ph-asterisk ph-xs text-danger"},null,-1),Ct={key:0,class:"text-red text-extra-small pt-1"},Vt=n("i",{class:"ph-plus-circle me-1"},null,-1),bt={style:{"padding-right":"200px"}},$t={style:{"padding-right":"200px"}},xt={key:0,class:"text-center"},St=n("i",{class:"ph-magnifying-glass",style:{"font-size":"30px"},color:"primary"},null,-1),wt={class:"font-weight-bold text-subtitle-1 mb-1"},Dt=n("i",{class:"ph-arrow-left ms-2"},null,-1),It=n("i",{class:"ph-floppy-disk ms-2"},null,-1),kt=Q({__name:"index",setup(B){const p=i(Fe),V=Ye(),b=O(()=>V.country_by_province),I=O(()=>p.value.query),F=Ke();Ee();const f=i(null),S=xe(),w=O(()=>String(S.query.id)),q=()=>{ee.push({path:"/baseTable/country/list"})},l=i({name:"",code:"",iso2Code:"",iso3Code:"",phoneCode:"",currency:"",currencySymbol:"",currencyCode:""}),{t:d}=de(),c=Se(),X=Te(),ee=we(),v=i(!1),h=i(!1),D=i(null),s=i({id:null,name:"",code:"",iso2Code:"",iso3Code:"",phoneCode:"",currency:"",currencySymbol:"",currencyCode:""}),U=()=>{let e=!0;return Object.keys(l.value).forEach(a=>{l.value[a]=""}),s.value.name||(l.value.name=d("t-please-enter-name"),e=!1),s.value.code?s.value.code.length<2||s.value.code.length>10?(l.value.code=d("t-code-must-be-between-2-and-10-chars"),e=!1):l.value.code="":(l.value.code=d("t-please-enter-code"),e=!1),s.value.iso2Code?s.value.iso2Code.length!==2&&(l.value.iso2Code=d("t-iso2-must-have-2-characters"),e=!1):(l.value.iso2Code=d("t-please-enter-iso2-code"),e=!1),s.value.iso3Code?s.value.iso3Code.length!==3&&(l.value.iso3Code=d("t-iso3-must-have-3-characters"),e=!1):(l.value.iso3Code=d("t-please-enter-iso3-code"),e=!1),s.value.phoneCode?/^\+\d{1,3}$/.test(s.value.phoneCode)||(l.value.phoneCode=d("t-invalid-phone-code"),e=!1):(l.value.phoneCode=d("t-please-enter-phone-code"),e=!1),s.value.currency||(l.value.currency=d("t-please-enter-currency"),e=!1),s.value.currencySymbol?s.value.currencySymbol.length<1||s.value.currencySymbol.length>10?(l.value.currencySymbol=d("t-currency-symbol-must-be-between-1-and-10-chars"),e=!1):l.value.currencySymbol="":(l.value.currencySymbol=d("t-please-enter-currency-symbol"),e=!1),s.value.currencyCode?s.value.currencyCode.length<2||s.value.currencyCode.length>10?(l.value.currencyCode=d("t-currency-code-must-be-between-2-and-10-chars"),e=!1):l.value.currencyCode="":(l.value.currencyCode=d("t-please-enter-currency-code"),e=!1),e},A=i(!1),H=i(null),te=i(!1);i(!1),i(!1);const P=i([]),N=i([]);E(f,e=>{e&&(s.value={id:e.id,name:e.name,code:e.code,iso2Code:e.iso2Code,iso3Code:e.iso3Code,phoneCode:e.phoneCode,currency:e.currency,currencySymbol:e.currencySymbol,currencyCode:e.currencyCode})}),E(b,e=>{if(e&&Array.isArray(e)){const a=e.map(m=>({...m,isCheck:!1})).toReversed();P.value=a,N.value=a}},{immediate:!0}),De(async()=>{if(w.value){const e=await F.fetchCountryByID(w.value);f.value=e,await V.fetchProvinceByCountryID(w.value),ae()}});const G=i(1),le=O(()=>N.value.length),z=i([]),T=i(!1),k=i({page:G.value,start:0,end:0,noOfItems:le.value,itemsPerPage:10}),ae=()=>{const{itemsPerPage:e,page:a}=k.value,m=(a-1)*e;let g=m+e;g=g<=le.value?g:le.value,k.value={...k.value,start:m,end:g};const W=N.value.slice(k.value.start,k.value.end);T.value=!0,z.value=[],setTimeout(()=>{z.value=W,T.value=!1},200)};E(G,e=>{k.value.page=e,ae()}),E(P,e=>{oe(e)});const oe=e=>{T.value=!0;const{itemsPerPage:a}=k.value,m=1;let g=m+a;g=g<=e.length?g:e.length,z.value=[],setTimeout(()=>{z.value=e,k.value={...k.value,start:m,end:g,noOfItems:e.length},T.value=!1},200)};E(I,e=>{P.value=N.value.filter(a=>{const m=e.toLowerCase();if(a.name.toLowerCase().includes(m)||a.code.includes(m))return a}),oe(P.value)}),E(v,e=>{e||(D.value=null)});const ne=e=>{e?D.value=e:D.value={id:"-1",name:"",code:""},v.value=!0},me=async(e,a)=>{var m,g;try{e.id?(await K.updateProvince(e.id,e),c.success(d("t-toast-message-update"))):(await K.createProvince(e),c.success(d("t-toast-message-created"))),V.fetchProvinceByCountryID(w.value),(m=a==null?void 0:a.onSuccess)==null||m.call(a)}catch{c.error(d("t-message-save-error"))}finally{(g=a==null?void 0:a.onFinally)==null||g.call(a)}};E(h,e=>{e||(D.value=null)});const pe=e=>{e?D.value=e:D.value={id:"-1",name:"",code:""},h.value=!0};E(A,e=>{e||(H.value=null)});const ye=e=>{H.value=e,A.value=!0},fe=async()=>{te.value=!0;try{await K.deleteProvince(H.value),P.value=P.value.filter(e=>e.id!==H.value),N.value=[...P.value],oe(P.value),c.success(d("t-toast-message-deleted"))}catch{c.error(d("t-toast-message-deleted-erros"))}finally{te.value=!1,A.value=!1}},he=async()=>{if(U())try{if(T.value=!0,!s.value.id){c.error(d("t-missing-country-id"));return}await ve.updateCountry(s.value.id,s.value),c.success(d("t-toast-message-update")),await X.fetchCountries(),ae()}catch{c.error(d("t-message-save-error"))}finally{T.value=!1}},ge=(e,a)=>{switch(e){case"view":pe(a);break;case"edit":ne(a);break;case"delete":ye(a.id);break}};return(e,a)=>{const m=j("TextField"),g=j("Card"),W=j("ListMenuWithIcon");return y(),_(re,null,[t(g,{title:""},{default:o(()=>[t(M,null,{default:o(()=>[t(se,null,{default:o(()=>[t(M,{class:"pt-0"},{default:o(()=>[t(L,{class:""},{default:o(()=>[t(x,{cols:"12",lg:"6"},{default:o(()=>[n("div",Ze,[C(u(e.$t("t-country-name"))+" ",1),Qe]),t(m,{modelValue:s.value.name,"onUpdate:modelValue":a[0]||(a[0]=r=>s.value.name=r),placeholder:e.$t("t-country-name"),"error-messages":l.value.name?[l.value.name]:[],"hide-details":""},null,8,["modelValue","placeholder","error-messages"]),l.value.name?(y(),_("div",Xe,u(l.value.name),1)):$("",!0)]),_:1}),t(x,{cols:"12",lg:"6"},{default:o(()=>[n("div",et,[C(u(e.$t("t-country-code"))+" ",1),tt]),t(m,{modelValue:s.value.code,"onUpdate:modelValue":a[1]||(a[1]=r=>s.value.code=r),placeholder:e.$t("t-enter-code"),"error-messages":l.value.code?[l.value.code]:[],"hide-details":""},null,8,["modelValue","placeholder","error-messages"]),l.value.code?(y(),_("div",lt,u(l.value.code),1)):$("",!0)]),_:1})]),_:1}),t(L,{class:""},{default:o(()=>[t(x,{cols:"12",lg:"6"},{default:o(()=>[n("div",at,[C(u(e.$t("t-iso2Code"))+" ",1),ot]),t(m,{modelValue:s.value.iso2Code,"onUpdate:modelValue":a[2]||(a[2]=r=>s.value.iso2Code=r),placeholder:e.$t("t-enter-iso2-code"),"error-messages":l.value.iso2Code?[l.value.iso2Code]:[],"hide-details":""},null,8,["modelValue","placeholder","error-messages"]),l.value.iso2Code?(y(),_("div",st,u(l.value.iso2Code),1)):$("",!0)]),_:1}),t(x,{cols:"12",lg:"6"},{default:o(()=>[n("div",rt,[C(u(e.$t("t-iso3Code"))+" ",1),nt]),t(m,{modelValue:s.value.iso3Code,"onUpdate:modelValue":a[3]||(a[3]=r=>s.value.iso3Code=r),placeholder:e.$t("t-enter-iso3-code"),"error-messages":l.value.iso3Code?[l.value.iso3Code]:[],"hide-details":""},null,8,["modelValue","placeholder","error-messages"]),l.value.iso3Code?(y(),_("div",ut,u(l.value.iso3Code),1)):$("",!0)]),_:1})]),_:1}),t(L,{class:""},{default:o(()=>[t(x,{cols:"12",lg:"6"},{default:o(()=>[n("div",dt,[C(u(e.$t("t-phone-code"))+" ",1),it]),t(m,{modelValue:s.value.phoneCode,"onUpdate:modelValue":a[4]||(a[4]=r=>s.value.phoneCode=r),placeholder:e.$t("t-enter-phone-code"),"error-messages":l.value.phoneCode?[l.value.phoneCode]:[],"hide-details":""},null,8,["modelValue","placeholder","error-messages"]),l.value.phoneCode?(y(),_("div",ct,u(l.value.phoneCode),1)):$("",!0)]),_:1}),t(x,{cols:"12",lg:"6"},{default:o(()=>[n("div",vt,[C(u(e.$t("t-currency"))+" ",1),mt]),t(m,{modelValue:s.value.currency,"onUpdate:modelValue":a[5]||(a[5]=r=>s.value.currency=r),placeholder:e.$t("t-enter-currency"),"error-messages":l.value.currency?[l.value.currency]:[],"hide-details":""},null,8,["modelValue","placeholder","error-messages"]),l.value.currency?(y(),_("div",pt,u(l.value.currency),1)):$("",!0)]),_:1})]),_:1}),t(L,{class:""},{default:o(()=>[t(x,{cols:"12",lg:"6"},{default:o(()=>[n("div",yt,[C(u(e.$t("t-currency-symbol"))+" ",1),ft]),t(m,{modelValue:s.value.currencySymbol,"onUpdate:modelValue":a[6]||(a[6]=r=>s.value.currencySymbol=r),placeholder:e.$t("t-enter-currency-symbol"),"error-messages":l.value.currencySymbol?[l.value.currencySymbol]:[],"hide-details":""},null,8,["modelValue","placeholder","error-messages"]),l.value.currencySymbol?(y(),_("div",ht,u(l.value.currencySymbol),1)):$("",!0)]),_:1}),t(x,{cols:"12",lg:"6"},{default:o(()=>[n("div",gt,[C(u(e.$t("t-currency-code"))+" ",1),_t]),t(m,{modelValue:s.value.currencyCode,"onUpdate:modelValue":a[7]||(a[7]=r=>s.value.currencyCode=r),placeholder:e.$t("t-enter-currency-code"),"error-messages":l.value.currencyCode?[l.value.currencyCode]:[],"hide-details":""},null,8,["modelValue","placeholder","error-messages"]),l.value.currencyCode?(y(),_("div",Ct,u(l.value.currencyCode),1)):$("",!0)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(M,null,{default:o(()=>[t(g,{title:e.$t("t-province-list"),"title-class":"pt-0"},{"title-action":o(()=>[n("div",null,[t(R,{color:"primary",class:"mx-1",onClick:a[8]||(a[8]=ke(r=>ne(null),["prevent"]))},{default:o(()=>[Vt,C(" "+u(e.$t("t-add-province")),1)]),_:1})])]),_:1},8,["title"]),t(L,{class:"mt-5"},{default:o(()=>[t(x,{cols:"12",lg:"12"},{default:o(()=>[t(je,{modelValue:p.value,"onUpdate:modelValue":a[9]||(a[9]=r=>p.value=r)},null,8,["modelValue"]),t(se,{class:"mt-5"},{default:o(()=>[t(M,null,{default:o(()=>[t(Be,{modelValue:G.value,"onUpdate:modelValue":a[10]||(a[10]=r=>G.value=r),headerItems:Z(qe).map(r=>({...r,title:e.$t(`t-${r.title}`)})),config:k.value,loading:T.value,"is-pagination":"",class:"ma-n2"},{body:o(()=>[(y(!0),_(re,null,Ue(z.value,(r,_e)=>(y(),_("tr",{key:"agent-listing-item-"+_e,height:"50"},[n("td",bt,u(r.name),1),n("td",$t,u(r.code),1),n("td",null,[t(W,{menuItems:Z(Me).map(J=>({...J,title:e.$t(`t-${J.title}`)})),onOnSelect:J=>ge(J,r)},null,8,["menuItems","onOnSelect"])])]))),128))]),_:1},8,["modelValue","headerItems","config","loading"]),P.value.length?$("",!0):(y(),_("div",xt,[t(Pe,{size:"80",color:"primary",variant:"text"},{default:o(()=>[St]),_:1}),n("div",wt,u(e.$t("t-search-not-found-message")),1)]))]),_:1})]),_:1})]),_:1})]),_:1}),t(ie,{class:"d-flex justify-space-between"},{default:o(()=>[t(R,{color:"secondary",variant:"outlined",class:"me-2",onClick:a[11]||(a[11]=r=>q())},{default:o(()=>[C(u(e.$t("t-back"))+" ",1),Dt]),_:1}),t(R,{color:"success",variant:"elevated",loading:T.value,disabled:!s.value.name||!s.value.code,onClick:he},{default:o(()=>[C(u(e.$t("t-save"))+" ",1),It]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1}),D.value?(y(),Y(Je,{key:0,country:w.value,modelValue:v.value,"onUpdate:modelValue":a[12]||(a[12]=r=>v.value=r),data:D.value,onOnSubmit:me},null,8,["country","modelValue","data"])):$("",!0),H.value?(y(),Y(Ie,{key:1,modelValue:A.value,"onUpdate:modelValue":a[13]||(a[13]=r=>A.value=r),onOnConfirm:fe,loading:te.value},null,8,["modelValue","loading"])):$("",!0)],64)}}}),Ft=Q({__name:"ListView",setup(B){return(p,V)=>{const b=j("Breadcrumb");return y(),_(re,null,[t(b,{title:"edit-country",items:Z(Le)},null,8,["items"]),t(kt)],64)}}});export{Ft as default};
