import{d as R,l as r,c as U,J as K,B,b as T,e as O,w as a,x as t,O as F,aD as q,C as W,y as le,a1 as ie,h as D,D as J,G as I,i as u,Q as k,I as h,f as E,a3 as oe,ab as se,Z as ue,aJ as N,K as pe,L as ce,af as me,m as ee,M as L,aF as ve,N as fe,g as A,R as ge,H as ye,F as G,E as he,S as _e,V as Ve,W as Pe}from"./index-1db35709.js";import{_ as Te}from"./TableAction.vue_vue_type_script_setup_true_lang-6eb16471.js";import{D as $e}from"./DataTableServer-f256364c.js";const xe=[{title:"hospital_procedure_types",disabled:!1},{title:"view-list-hospital_procedure_types",disabled:!0}],te=[{title:"name",key:"name",sortable:!0},{title:"description",key:"description",sortable:!0},{title:"action",sortable:!1}],we={class:"font-weight-bold text-caption mb-1"},Ce=u("i",{class:"ph-asterisk ph-xs text-danger"},null,-1),be={key:0,class:"text-red text-extra-small pt-1"},Se={class:"font-weight-bold text-caption mb-1"},Ie={key:0,class:"text-red text-extra-small pt-1"},De=u("i",{class:"ph-x me-1"},null,-1),Ee=R({__name:"CreateUpdateHospitalProcedureTypeModal",props:{modelValue:{type:Boolean,default:!1},data:{type:Object,required:!0},error:{type:String,default:""}},emits:["update:modelValue","onSubmit"],setup(m,{emit:v}){const f=r(!1),g=v,$=m,P=U(()=>$.data.id==="-1"),n=r($.data),x=U(()=>$.error),c=U({get(){return $.modelValue},set(s){g("update:modelValue",s)}}),d=r(n.value.id||""),p=r(n.value.name||""),i=r(n.value.description||""),_=r({name:"",description:""}),{t:M}=K(),b=()=>{let s=!0;return Object.keys(_.value).forEach(V=>{_.value[V]=""}),p.value||(_.value.name=M("t-please-enter-name-hospital-procedure-type"),s=!1),s},w=()=>{if(!b())return;f.value=!0;const s={...!P.value&&{id:d.value},name:p.value,description:i.value};g("onSubmit",s,{onSuccess:()=>{c.value=!1},onFinally:()=>{f.value=!1}})};return(s,V)=>{const H=B("TextField"),Q=B("TextArea"),z=B("Card");return T(),O(se,{modelValue:c.value,"onUpdate:modelValue":V[4]||(V[4]=S=>c.value=S),width:"500",scrollable:""},{default:a(()=>[t(z,{title:P.value?s.$t("t-add-hospital-procedure-type"):s.$t("t-edit-hospital-procedure-type"),"title-class":"py-0",style:{overflow:"hidden"}},{"title-action":a(()=>[t(F,{icon:"ph-x",variant:"plain",onClick:V[0]||(V[0]=S=>c.value=!1)})]),default:a(()=>[t(q),t(W,{class:"overflow-y-auto",style:le({"max-height":P.value?"70vh":"45vh"})},{default:a(()=>[x.value?(T(),O(ie,{key:0,text:x.value,type:"error",class:"mb-4",variant:"tonal",color:"danger",density:"compact"},null,8,["text"])):D("",!0),t(J,null,{default:a(()=>[t(I,{cols:"12",lg:"12"},{default:a(()=>[u("div",we,[k(h(s.$t("t-name"))+" ",1),Ce]),t(H,{modelValue:p.value,"onUpdate:modelValue":V[1]||(V[1]=S=>p.value=S),placeholder:s.$t("t-enter-name"),"error-messages":_.value.name?[_.value.name]:[],"hide-details":""},null,8,["modelValue","placeholder","error-messages"]),_.value.name?(T(),E("div",be,h(_.value.name),1)):D("",!0)]),_:1}),t(I,{cols:"12",lg:"12"},{default:a(()=>[u("div",Se,h(s.$t("t-description")),1),t(Q,{modelValue:i.value,"onUpdate:modelValue":V[2]||(V[2]=S=>i.value=S),placeholder:s.$t("t-enter-description"),"error-messages":_.value.description?[_.value.description]:[],"hide-details":""},null,8,["modelValue","placeholder","error-messages"]),_.value.description?(T(),E("div",Ie,h(_.value.description),1)):D("",!0)]),_:1})]),_:1})]),_:1},8,["style"]),t(q),t(oe,{class:"d-flex justify-end"},{default:a(()=>[u("div",null,[t(F,{color:"danger",class:"me-1",onClick:V[3]||(V[3]=S=>c.value=!1)},{default:a(()=>[De,k(" "+h(s.$t("t-close")),1)]),_:1}),t(F,{color:"primary",variant:"elevated",onClick:w,loading:f.value,disabled:f.value},{default:a(()=>[k(h(f.value?s.$t("t-saving"):s.$t("t-save")),1)]),_:1},8,["loading","disabled"])])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}});const He={class:"font-weight-bold text-caption mb-1"},Ue=u("i",{class:"ph-asterisk ph-xs text-danger"},null,-1),Be={key:0,class:"text-red text-extra-small pt-1"},Oe={class:"font-weight-bold text-caption mb-1"},Fe={key:0,class:"text-red text-extra-small pt-1"},ke=u("i",{class:"ph-x me-1"},null,-1),Me=R({__name:"ViewHospitalProcedureTypeModal",props:{modelValue:{type:Boolean,default:!1},data:{type:Object,required:!0}},emits:["update:modelValue","onSubmit"],setup(m,{emit:v}){r(!1);const f=v,g=m,$=U(()=>g.data.id==="-1"),P=r(g.data),n=U({get(){return g.modelValue},set(p){f("update:modelValue",p)}});r(P.value.id||"");const x=r(P.value.name||""),c=r(P.value.description||""),d=r({name:"",description:""});return K(),(p,i)=>{const _=B("TextField"),M=B("TextArea"),b=B("Card");return T(),O(se,{modelValue:n.value,"onUpdate:modelValue":i[4]||(i[4]=w=>n.value=w),width:"500",scrollable:""},{default:a(()=>[t(b,{title:p.$t("t-view-hospital-procedure-type"),"title-class":"py-0",style:{overflow:"hidden"}},{"title-action":a(()=>[t(F,{icon:"ph-x",variant:"plain",onClick:i[0]||(i[0]=w=>n.value=!1)})]),default:a(()=>[t(q),t(W,{class:"overflow-y-auto",style:le({"max-height":$.value?"70vh":"45vh"})},{default:a(()=>[t(J,null,{default:a(()=>[t(I,{cols:"12",lg:"12"},{default:a(()=>[u("div",He,[k(h(p.$t("t-name"))+" ",1),Ue]),t(_,{modelValue:x.value,"onUpdate:modelValue":i[1]||(i[1]=w=>x.value=w),placeholder:p.$t("t-enter-name"),"error-messages":d.value.name?[d.value.name]:[],"hide-details":"",disabled:""},null,8,["modelValue","placeholder","error-messages"]),d.value.name?(T(),E("div",Be,h(d.value.name),1)):D("",!0)]),_:1}),t(I,{cols:"12",lg:"12"},{default:a(()=>[u("div",Oe,h(p.$t("t-description")),1),t(M,{modelValue:c.value,"onUpdate:modelValue":i[2]||(i[2]=w=>c.value=w),placeholder:p.$t("t-enter-description"),"error-messages":d.value.description?[d.value.description]:[],"hide-details":"",disabled:""},null,8,["modelValue","placeholder","error-messages"]),d.value.description?(T(),E("div",Fe,h(d.value.description),1)):D("",!0)]),_:1})]),_:1})]),_:1},8,["style"]),t(q),t(oe,{class:"d-flex justify-end"},{default:a(()=>[u("div",null,[t(F,{color:"danger",class:"me-1",onClick:i[3]||(i[3]=w=>n.value=!1)},{default:a(()=>[ke,k(" "+h(p.$t("t-close")),1)]),_:1})])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"])}}});const je=ue("hospital_procedure_types",{state:()=>({hospital_procedure_types:[],pagination:{totalElements:0,currentPage:0,itemsPerPage:10,totalPages:0},loading:!1,error:null,draftProcedureType:null,currentProcedureTypeId:null}),actions:{async fetchHospitalProcedureTypes(m,v,f="name",g="asc",$,P){this.loading=!0,this.error=null;const n=m??this.pagination.currentPage,x=v??this.pagination.itemsPerPage;try{const{content:c,meta:d}=await N.getHospitalProcedureTypes(n,x,f,g,$,P);this.hospital_procedure_types=c,this.pagination={totalElements:d.totalElements,currentPage:d.page,itemsPerPage:d.size,totalPages:d.totalPages||Math.ceil(d.totalElements/d.size)},console.log("🏥 Tipos de Procedimentos Hospitalares:",this.hospital_procedure_types),console.log("📄 Meta:",this.pagination)}catch(c){this.error=c.message||"Erro ao buscar os tipos de procedimentos hospitalares",this.hospital_procedure_types=[],this.pagination.totalElements=0,console.error("❌ Erro ao buscar hospital_procedure_types:",c)}finally{this.loading=!1}},setDraftProcedureType(m){this.draftProcedureType=m,localStorage.setItem("draftProcedureType",JSON.stringify(m)),console.log("📋 Draft de tipo de procedimento salvo:",this.draftProcedureType)},setCurrentProcedureTypeId(m){this.currentProcedureTypeId=m,localStorage.setItem("currentProcedureTypeId",m),console.log("🆔 ID do tipo de procedimento atual salvo:",this.currentProcedureTypeId)},clearDraft(){this.draftProcedureType=null,this.currentProcedureTypeId=null,localStorage.removeItem("draftProcedureType"),localStorage.removeItem("currentProcedureTypeId"),console.log("🧹 Draft e ID de tipo de procedimento limpos")},loadFromStorage(){const m=localStorage.getItem("draftProcedureType"),v=localStorage.getItem("currentProcedureTypeId");m&&(this.draftProcedureType=JSON.parse(m)),v&&(this.currentProcedureTypeId=v),console.log("📦 Carregado do armazenamento:",this.draftProcedureType,this.currentProcedureTypeId)}}}),Ae={class:"text-body-1 font-weight-bold"},ze=u("i",{class:"ph-plus-circle me-1"},null,-1),Le=["colspan"],Ne=u("i",{class:"ph-magnifying-glass",style:{"font-size":"30px"}},null,-1),qe={class:"text-subtitle-1 font-weight-bold mt-3"},ae="name,description",Je=R({__name:"index",setup(m){const{t:v}=K(),f=pe(),g=je();ce();const $=r(!1),P=r(!1),n=r(null),x=r(!1),c=r(null),d=r(!1);r(!1);const p=r(""),i=r(10),_=U(()=>g.loading),M=U(()=>g.pagination.totalElements),b=r([]),w=r("");let s=null;const V=e=>{var o,y,C,j,Z,X,Y;s&&(clearTimeout(s),s=null);const l=((Z=(j=(C=(y=(o=e==null?void 0:e.response)==null?void 0:o.data)==null?void 0:y.error)==null?void 0:C.errors)==null?void 0:j.name)==null?void 0:Z[0])||((Y=(X=e==null?void 0:e.response)==null?void 0:X.data)==null?void 0:Y.message)||(e==null?void 0:e.message)||v("t-message-save-error");w.value=l,s=setTimeout(()=>{w.value="",s=null},5e3)};me(()=>{s&&(clearTimeout(s),s=null)}),ee(()=>{H({page:1,itemsPerPage:i.value,sortBy:[],search:""})}),ee(()=>{H({page:1,itemsPerPage:i.value,sortBy:[],search:""})}),L(b,e=>{console.log("Funcionários selecionados:",e)},{deep:!0});const H=async({page:e,itemsPerPage:l,sortBy:o,search:y})=>{var C,j;await g.fetchHospitalProcedureTypes(e-1,l,((C=o[0])==null?void 0:C.key)||"name",((j=o[0])==null?void 0:j.order)||"asc",y,ae)},Q=e=>{b.value.findIndex(o=>o.id===e.id)===-1?b.value=[...b.value,e]:b.value=b.value.filter(o=>o.id!==e.id)};L($,e=>{e||(n.value=null)});const z=e=>{e?n.value=e:n.value={id:"-1",name:"",description:""},$.value=!0},S=async(e,l)=>{var o,y;try{e.id?(await N.updateHospitalProcedureType(e.id,e),f.success(v("t-toast-message-update"))):(await N.createHospitalProcedureType(e),f.success(v("t-toast-message-created"))),await H({page:1,itemsPerPage:i.value,sortBy:[],search:p.value}),(o=l==null?void 0:l.onSuccess)==null||o.call(l)}catch(C){f.error(v("t-message-save-error")),V(C)}finally{(y=l==null?void 0:l.onFinally)==null||y.call(l)}};L(P,e=>{e||(n.value=null)});const re=e=>{e?n.value=e:n.value={id:"-1",name:"",description:""},P.value=!0};L(x,e=>{e||(c.value=null)});const ne=e=>{c.value=e,x.value=!0},de=async()=>{d.value=!0;try{await N.deleteHospitalProcedureType(c.value),await H({page:1,itemsPerPage:i.value,sortBy:[],search:p.value}),f.success(v("t-toast-message-deleted"))}catch(e){f.error(v("t-toast-message-deleted-erros")),V(e)}finally{d.value=!1,x.value=!1}};return(e,l)=>(T(),E(G,null,[t(Ve,null,{default:a(()=>[t(ve,{class:"mt-2"},{default:a(()=>[t(J,{justify:"space-between",align:"center","no-gutters":""},{default:a(()=>[t(I,{lg:"auto",class:"d-flex align-center"},{default:a(()=>[u("span",Ae,h(e.$t("t-hospital-procedure-type-list")),1)]),_:1}),t(I,{lg:"8",class:"d-flex justify-end"},{default:a(()=>[t(J,{justify:"end",align:"center","no-gutters":""},{default:a(()=>[t(I,{lg:"4",class:"me-3"},{default:a(()=>[t(fe,{modelValue:p.value,"onUpdate:modelValue":l[0]||(l[0]=o=>p.value=o),placeholder:e.$t("t-search-for-hospital-procedure-type")},null,8,["modelValue","placeholder"])]),_:1}),t(I,{lg:"auto"},{default:a(()=>[t(F,{color:"secondary",onClick:l[1]||(l[1]=o=>z(null))},{default:a(()=>[ze,k(" "+h(e.$t("t-add-hospital-procedure-type")),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),t(W,{class:"mt-2"},{default:a(()=>[t($e,{headers:A(te).map(o=>({...o,title:e.$t(`t-${o.title}`)})),items:A(g).hospital_procedure_types,"items-per-page":i.value,"total-items":M.value,loading:_.value,"search-query":p.value,"search-props":ae,"item-value":"id",onLoadItems:H},ge({body:a(({items:o})=>[(T(!0),E(G,null,he(o,y=>(T(),E("tr",{key:y.id,height:"50"},[u("td",null,[t(_e,{"model-value":b.value.some(C=>C.id===y.id),"onUpdate:modelValue":C=>Q(y),"hide-details":"",density:"compact"},null,8,["model-value","onUpdate:modelValue"])]),u("td",null,h(y.name),1),u("td",null,h(y.description),1),u("td",null,[t(Te,{onOnEdit:C=>z(y),onOnView:C=>re(y),onOnDelete:C=>ne(y.id)},null,8,["onOnEdit","onOnView","onOnDelete"])])]))),128))]),_:2},[A(g).hospital_procedure_types.length?void 0:{name:"body",fn:a(()=>[u("tr",null,[u("td",{colspan:A(te).length+2,class:"text-center py-10"},[t(ye,{size:"80",color:"primary",variant:"tonal"},{default:a(()=>[Ne]),_:1}),u("div",qe,h(e.$t("t-search-not-found-message")),1)],8,Le)])]),key:"0"}]),1032,["headers","items","items-per-page","total-items","loading","search-query"])]),_:1})]),_:1}),n.value?(T(),O(Ee,{key:0,modelValue:$.value,"onUpdate:modelValue":l[2]||(l[2]=o=>$.value=o),data:n.value,error:w.value,onOnSubmit:S},null,8,["modelValue","data","error"])):D("",!0),n.value?(T(),O(Me,{key:1,modelValue:P.value,"onUpdate:modelValue":l[3]||(l[3]=o=>P.value=o),data:n.value},null,8,["modelValue","data"])):D("",!0),c.value?(T(),O(Pe,{key:2,modelValue:x.value,"onUpdate:modelValue":l[4]||(l[4]=o=>x.value=o),onOnConfirm:de,loading:d.value},null,8,["modelValue","loading"])):D("",!0)],64))}}),Ke=R({__name:"ListView",setup(m){return(v,f)=>{const g=B("Breadcrumb");return T(),E(G,null,[t(g,{title:"hospital-procedure-type-list",items:A(xe)},null,8,["items"]),t(Je)],64)}}});export{Ke as default};
